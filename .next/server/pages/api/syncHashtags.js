"use strict";(()=>{var e={};e.id=51,e.ids=[51],e.modules={1287:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3905:(e,r,t)=>{t.r(r),t.d(r,{config:()=>d,default:()=>u,routeModule:()=>c});var s={};t.r(s),t.d(s,{default:()=>handler});var a=t(1802),i=t(7153),n=t(6249);let o=require("@supabase/supabase-js"),l=null;async function handler(e,r){if("POST"!==e.method)return r.status(405).end();let{tweetId:t,content:s}=e.body;if(!t||!s)return r.status(400).json({error:"Missing tweetId or content"});let a=function(){if(!l){let e=process.env.SUPABASE_KEY;if(!e)throw Error("Supabase key is missing. Set SUPABASE_KEY in your environment variables.");l=(0,o.createClient)("https://xadpyaiwqrrwzlqrlysz.supabase.co",e)}return l}(),i=function(e){let r=e.match(/#(\w+)/g);return r?r.map(e=>e.slice(1).toLowerCase()):[]}(s);for(let e of i){let{data:r,error:s}=await a.from("hashtags").select("tweet_ids").eq("tag",e).single();if(s&&"PGRST116"!==s.code){console.error(`Error fetching hashtag ${e}:`,s);continue}if(r){let s=r.tweet_ids||[];s.includes(t)||s.push(t);let{error:i}=await a.from("hashtags").update({tweet_ids:s}).eq("tag",e);i&&console.error(`Error updating hashtag ${e}:`,i)}else{let{error:r}=await a.from("hashtags").insert({tag:e,tweet_ids:[t]});r&&console.error(`Error inserting hashtag ${e}:`,r)}}r.status(200).json({success:!0,hashtags:i})}let u=(0,n.l)(s,"default"),d=(0,n.l)(s,"config"),c=new a.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/syncHashtags",pathname:"/api/syncHashtags",bundlePath:"",filename:""},userland:s})}};var r=require("../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[222],()=>__webpack_exec__(3905));module.exports=t})();